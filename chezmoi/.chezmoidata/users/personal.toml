####################################################################################################
# For darwin
####################################################################################################
[darwin]

[darwin.users.sumi]
externals = []
[darwin.users.sumi.sops]
"pkgs/ai-tools/env" = ".env"
"pkgs/ssh/univ" = ".ssh/conf.d/hosts/univ"

[darwin.users.sumi.env]
initExtra = ""
extraConfig = ""
PATH = ["$HOME/bin", "$HOME/.local/bin"]
[darwin.users.sumi.env.export]
[darwin.users.sumi.env.alias]

[darwin.users.sumi.packages.homebrew]
brew = ["sox", "neovim"]
cask = ["vivaldi", "firefox"]

####################################################################################################
# For linux
####################################################################################################
[linux.users.sumi]
externals = ["blesh", "tpm"]
[linux.users.sumi.sops]
"pkgs/ai-tools/env" = ".env"
"pkgs/ssh/univ" = ".ssh/conf.d/hosts/univ"

[linux.users.sumi.env]
initExtra = ""
extraConfig = ""
PATH = ["$HOME/bin", "$HOME/.local/bin", "$HOME/.local/share/mcp-servers/bin"]
[linux.users.sumi.env.export]
EDITOR = "nvim"
FZF_ALT_C_COMMAND = "fd --type d"
FZF_ALT_C_OPTS = "--preview 'tree -C {} | tree -200'"
FZF_CTRL_R_OPTS = "--preview 'echo {}' --preview-window up:3:hidden:wrap --bind 'ctrl-/:toggle-preview' --bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort' --color header:italic --header 'Press CTRL-Y to copy command into clipboard'"
FZF_CTRL_T_COMMAND = "fd --type f"
FZF_CTRL_T_OPTS = "--preview 'bat -n --color: always {}' --bind 'ctrl-/:change-preview-window(down|hidden|)'"
FZF_TMUX = "1"
FZF_TMUX_OPTS = "-p -w 80% -h 70%"
JQ_COLORS = "1;30:0;37:0;37:0;37:0;32:1;37:1;37"
LG_CONFIG_FILE = "$XDG_CONFIG_HOME/lazygit/config.yml"
MANPAGER = "sh -c 'sed -u -e \\\"s%\\\\x1B\\[[0-9;]*m%%g; s%.\\\\x08%%g\\\" | bat -p -lman'"
TMUX_TMPDIR = "${XDG_RUNTIME_DIR:-/run/user/$(id -u)}"
[linux.users.sumi.env.alias]
vimdiff = "nvim -d"
copilot = "wrapEnv copilot"
mcp-hub = "wrapEnv mcp-hub"

[linux.users.sumi.packages.mcpServers.node] # name = "package_name", name is executable name
mcp-server-filesystem = "@modelcontextprotocol/server-filesystem"
mcp-server-memory = "@modelcontextprotocol/server-memory"
mcp-server-sequential-thinking = "@modelcontextprotocol/server-sequential-thinking"
context7-mcp = "@upstash/context7-mcp"
copilot = "@github/copilot"
gemini = "@google/gemini-cli"
mcp-hub = "mcp-hub@latest"
[linux.users.sumi.packages.mcpServers.pip] # name = "module_name", name is executable name
mcp-server-git = "mcp_server_git"
mcp-nixos = "mcp_nixos"
[linux.users.sumi.packages.mcpServers.github] # name = "module_name", name is executable name
owner = "github"
repo = "github-mcp-server"
srcFile = "github-mcp-server_Windows_x86_64.zip"
exeFile = "github-mcp-server.exe"

[linux.users.sumi.packages.mise.settings]
idiomatic_version_file = true
always_keep_download = false
always_keep_install = false
plugin_autoupdate_last_check_duration = "1 week"
verbose = false
http_timeout = "30s"
jobs = 4
raw = false
yes = false
not_found_auto_install = true
auto_install = true
experimental = true
idiomatic_version_file_enable_tools = []
[linux.users.sumi.packages.mise.plugins]
neovim = "asdf:neovim"
[linux.users.sumi.packages.mise.tools]
bat = "latest"
btop = "latest"
cmake = "latest"
delta = "latest"
deno = "latest"
duf = "latest"
fd = "latest"
ffmpeg = "latest"
fzf = "latest"
github-cli = "latest"
go = "latest"
imagemagick = "latest"
jq = "latest"
lazygit = "latest"
neovim = "latest"
node = "latest"
python = "latest"
ripgrep = "latest"
rust = "latest"
sops = "latest"
starship = "latest"
tmux = "latest"
tree-sitter = "latest"
usage = "latest"
uv = "latest"
yazi = "latest"
yt-dlp = "latest"
zoxide = "latest"
# darwin and linux support user define package manager
# [linux.users.sumi.packages.apt]
# need_sudo = true
# installCmd = "apt install" # No need for sudo because it will be elevated to privileges inside the shell script
# options = ["-y"]
# extraPreInstall = """
# apt add-apt-repository ppa:neovim-ppa/stable
# apt update
# """
# extraPostInstall = """
# apt remove --autoremove
# """
# apps = ["neovim", "sox"]

####################################################################################################
# For windows
####################################################################################################
[windows.users.sumi.sops]
"pkgs\\ai-tools\\api-keys.yaml" = ".config\\codecompanion\\api-keys.yaml"
"pkgs\\ai-tools\\env" = ".env"
"pkgs\\ssh\\desktops" = ".ssh\\conf.d\\hosts\\desktops"

[windows.users.sumi.env]
PATH = [
    "$env:USERPROFILE\\bin",
    "$env:USERPROFILE\\.local\\bin",
    "$env:USERPROFILE\\.local\\share\\mcp-servers\\bin",
    "$env:USERPROFILE\\.dotnet\\tools",
    "$env:USERPROFILE\\scoop\\apps\\git\\current\\mingw64\\bin",
    "$env:USERPROFILE\\scoop\\apps\\git\\current\\mingw64\\libexec\\git-core",
    "$env:USERPROFILE\\scoop\\apps\\git\\current\\usr\\bin",
    "$env:USERPROFILE\\scoop\\apps\\nodejs-lts\\current",
    "$env:USERPROFILE\\scoop\\apps\\nodejs-lts\\current\\bin",
    "$env:USERPROFILE\\scoop\\apps\\python\\current",
    "$env:USERPROFILE\\scoop\\apps\\python\\current\\Scripts",
    "$env:USERPROFILE\\scoop\\apps\\ruby\\current\\bin",
    "$env:USERPROFILE\\scoop\\apps\\ruby\\current\\gems\\bin",
    "$env:USERPROFILE\\scoop\\shims",
    "$env:LOCALAPPDATA\\Microsoft\\WindowsApps",
]
extraConfig = '''
function WrapEnv {
    param (
        [string]$Command,
        [Parameter(ValueFromRemainingArguments = $true)]
        $Args
    )
    $VarsFile = "$env:USERPROFILE\.env"
    if (Test-Path $VarsFile) {
        Get-Content $VarsFile | ForEach-Object {
            if ($_ -match '^(.*?)=(.*)$') {
                $name = $matches[1]
                $value = $matches[2]
                [System.Environment]::SetEnvironmentVariable($name, $value, "Process")
            }
        }
    }
    $processArgs = @($Command) + $Args
    & $Command @Args
}

function WrapCopilot {
    param (
        [Parameter(ValueFromRemainingArguments = $true)]
        $Args
    )
    WrapEnv copilot.cmd $Args
}
function WrapMcpHub {
    param (
        [Parameter(ValueFromRemainingArguments = $true)]
        $Args
    )
    WrapEnv mcp-hub.cmd $Args
}

Set-Alias -Name copilot -Value WrapCopilot
Set-Alias -Name mcp-hub -Value WrapMcpHub
'''
[windows.users.sumi.env.export]
FZF_ALT_C_COMMAND = "fd --type d"
FZF_ALT_C_OPTS = "--preview 'tree -C {} | tree -200'"
FZF_CTRL_R_OPTS = "--preview 'echo {}' --preview-window up:3:hidden:wrap --bind 'ctrl-/:toggle-preview' --bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort' --color header:italic --header 'Press CTRL-Y to copy command into clipboard'"
FZF_CTRL_T_COMMAND = "fd --type f"
FZF_CTRL_T_OPTS = "--preview 'bat -n --color=always {}' --bind 'ctrl-/:change-preview-window(down|hidden|)'"
JAVA_TOOL_OPTIONS = "-Dconsole.encoding=UTF-8 -Dfile.encoding=UTF-8"
KOMOREBI_CONFIG_HOME = "$env:USERPROFILE\\.config\\komorebi"
SOPS_AGE_KEY_FILE = "$env:USERPROFILE\\.config\\sops\\age\\keys.txt"
STARSHIP_CONFIG = "$env:USERPROFILE\\.config\\starship.toml"
XDG_CACHE_HOME = "$env:USERPROFILE\\.cache"
XDG_CONFIG_HOME = "$env:USERPROFILE\\.config"
XDG_DATA_HOME = "$env:USERPROFILE\\.local\\share"
XDG_STATE_HOME = "$env:USERPROFILE\\.local/state"
YAZI_FILE_ONE = "$env:USERPROFILE\\scoop\\apps\\git\\current\\usr\\bin\\file.exe"

[windows.users.sumi.packages.mcpServers.node] # name = "package_name", name is executable name
mcp-server-filesystem = "@modelcontextprotocol/server-filesystem"
mcp-server-memory = "@modelcontextprotocol/server-memory"
mcp-server-sequential-thinking = "@modelcontextprotocol/server-sequential-thinking"
context7-mcp = "@upstash/context7-mcp"
copilot = "@github/copilot"
gemini = "@google/gemini-cli"
mcp-hub = "mcp-hub@latest"
[windows.users.sumi.packages.mcpServers.pip] # name = "module_name", name is executable name
mcp-server-git = "mcp_server_git"
mcp-nixos = "mcp_nixos"
[windows.users.sumi.packages.mcpServers.github.github-mcp-server] # name = "module_name", name is executable name
owner = "github"
repo = "github-mcp-server"
srcFile = "github-mcp-server_Windows_x86_64.zip"
exeFile = "github-mcp-server.exe"

[windows.users.sumi.packages.powershell]
extraPreInstall = ""
extraPostInstall = ""
modules = [
    "NuGet",
    "M365PSProfile",
    "PSFzf",
    "PSWindowsUpdate",
    "Terminal-Icons",
    "WslInterop",
    "syntax-highlighting",
]
scripts = []

[windows.users.sumi.packages.vs_buildtools]
install = false
[windows.users.sumi.packages.winget]
extraPreInstall = ""
extraPostInstall = '''
sudo winget install Microsoft.VisualStudio.Community --override "--quiet --add Microsoft.VisualStudio.Workload.NativeDesktop"
'''
extraOptions = []
[windows.users.sumi.packages.winget.apps]
sudo = [
    "Adobe.CreativeCloud",
    "BlenderFoundation.Blender",
    "Discord.Discord",
    "GIMP.GIMP.3",
    "KDE.KDEConnect",
    "KDE.Krita",
    "Meta.Oculus",
    "MichaelTippach.ASIO4ALL",
    "RedHat.VirtIO",
    "Unity.UnityHub",
    "VRCX.VRCX",
    "VRChat.CreatorCompanion",
    "Valve.Steam",
    "VirtualDesktop.Streamer",
    "WinFsp.WinFsp",
    "WiresharkFoundation.Wireshark",
    "Zoom.Zoom",
    "Microsoft.Sysinternals.Suite",
    "Microsoft.VCRedist.2005.x86",
    "Microsoft.VCRedist.2005.x64",
    "Microsoft.VCRedist.2008.x86",
    "Microsoft.VCRedist.2008.x64",
    "Microsoft.VCRedist.2010.x86",
    "Microsoft.VCRedist.2010.x64",
    "Microsoft.VCRedist.2012.x86",
    "Microsoft.VCRedist.2012.x64",
    "Microsoft.VCRedist.2013.x86",
    "Microsoft.VCRedist.2013.x64",
    "Microsoft.VCRedist.2015+.x86",
    "Microsoft.VCRedist.2015+.x64",
    "NDI.NDIRuntime",
    "LGUG2Z.komorebi",
    "LGUG2Z.whkd",
    "Microsoft.WinDbg",
    "Microsoft.WindowsTerminal",
    "Mozilla.Firefox",
    "OBSProject.OBSStudio",
    "Vivaldi.Vivaldi",
    "File-New-Project.EarTrumpet",
    "GnuPG.Gpg4win",
    "voidtools.Everything.alpha",
    "lin-ycv.EverythingPowerToys",
    "stnkl.EverythingToolbar",
    "Microsoft.PowerToys",
    "Microsoft.WingetCreate",
    "RussellBanks.Komac",
    "nathancorvussolis.corvusskk",
]
no_sudo = ["Spotify.Spotify"]

[windows.users.sumi.packages.chocolatey]
extraPreInstall = ""
extraPostInstall = ""
extraOptions = []
[windows.users.sumi.packages.chocolatey.apps]
sudo = []
no_sudo = []

[windows.users.sumi.packages.scoop]
extraPreInstall = ""
extraPostInstall = ""
apps = [
    "7zip",
    "bat",
    "btop",
    "cmake",
    "ctags",
    "curl",
    "delta",
    "deno",
    "fastfetch",
    "fd",
    "ffmpeg",
    "fzf",
    "git",
    "go",
    "imagemagick",
    "jq",
    "lazygit",
    "less",
    "make",
    "mingw",
    "neovim",
    "nodejs-lts",
    "openssh",
    "poppler",
    "psutils",
    "python",
    "ripgrep",
    "ruby",
    "rustup",
    "scoop-completion",
    "sops",
    "starship",
    "tree-sitter",
    "unar",
    "uv",
    "vrc-alcom",
    "vrc-get",
    "wavesurfer",
    "wezterm",
    "wget",
    "yazi",
    "yq",
    "yubico-piv-tool",
    "yubikey-manager-qt",
    "yubikey-personalization",
    "yubikey-personalization-gui",
    "yubioath",
    "zip",
    "zoxide",
    "my-bucket/moralerspace-hw-nf",
    "my-bucket/moralerspace-nf",
    "my-bucket/wavesurfer",
    "my-bucket/yaskkserv2",
    "nerd-fonts/FiraCode-NF",
]
[windows.users.sumi.packages.scoop.buckets]
extras = "https://github.com/ScoopInstaller/Extras"
java = "https://github.com/ScoopInstaller/Java"
main = "https://github.com/ScoopInstaller/Main"
my-bucket = "https://github.com/Sumi-Sumi/scoop-bucket"
nerd-fonts = "https://github.com/matthewjberger/scoop-nerd-fonts"
versions = "https://github.com/ScoopInstaller/Versions"
xrtools = "https://github.com/babo4d/scoop-xrtools"
